## Redis 过期删除策略
我们知道，redis有一个设置过期时间功能，这样能有效设置缓存的过期时间，该功能极其实用。

比如咱们设计验证码时，经常会看见后面加个括弧（1分钟内有效）。这种就可以采用Redis的过期时间设置来实现。

比如
```
EXPIRE verifyCode 60
```
就是设置verifyCode1分钟后过期无效。

## 过期删除实现策略
既然它能保证一定时间后，某个键删除，那它内部实现会是什么样的呢？

别急，我们先自个想想，要是需求方给咱这么一个需求，咱们会怎么实现。

## 主动删除
主动删除策略，相信大家都能直接想到。不就是到点删键值对嘛，那我写个代码，到了点，把键值对删了就行。

比如写个回调函数，到过期时间后，执行回调函数，将键值对删除。

这个方法缺点也很明显： 如果时间不大对，该执行回调的时候，cpu忙炸了，那就压力太大了，影响了工作效率。

但这种方法客观上减少了内存的无效占用，感觉有点以时间（毕竟cpu忙的时间增加了）换空间的意思。

## 惰性删除
如果说主动删除是以时间换空间，那惰性删除就是另一种思路，以空间换时间。
采用这种方式，程序只会在取值的时候才会做检查，即通过key找到了这个键值对了，判断一下这个键值对是否过期，过期就删。

这个方法弊端也很明显，如果缓存里尽缓存了那些不会被二次访问的数据，那这些数据将长期霸占在内存中，很可能永远不会被删除。

## 定期删除
既然主动删除和惰性删除都有弊端，有没有方法可以扬长避短？

有的，那就是定期删除策略。这个方法非常朴素，就是每隔一定时间，执行一次删除，把内存中过期的键值对删干净。在没执行这个删除过程时，程序接着执行惰性删除策略。

这样一下，既发挥了主动删除的主动性，在执行期间又发挥了惰性删除的优势，非常不错。

